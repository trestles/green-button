<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.README.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-PVImpact+Green+Button+Gem">PVImpact Green Button Gem</h1>

<h2 id="label-Overview">Overview</h2>

<p>The Green Button Standard is a secure way of transmitting energy usage
information developed by the United States Department of Energy.</p>

<p>This gem provides functionality to download Green Button XML formatted data
from remote APIs, process the data and persist the data in database; it
also provides functionality to retrieve Green Button data persisted in
database.</p>

<h2 id="label-Setup+Prerequisites">Setup Prerequisites</h2>
<ul><li>
<p><a href="http://www.postgresql.org">PostgreSQL 9.4</a></p>
</li><li>
<p><a href="http://www.ruby-lang.org">Ruby 2.1.5</a></p>
</li><li>
<p><a href="https://rubygems.org">RubyGems 2.x</a></p>
</li><li>
<p><a href="http://rubyonrails.org">Ruby on Rails 3.2</a></p>
</li><li>
<p><a href="http://yardoc.org">Yard</a> - for generating documentation</p>
</li><li>
<p><a href="https://github.com/rubyworks/yard-tomdoc">yard-tomdoc</a> - for
generating documentation</p>
</li><li>
<p><a href="http://bundler.io">Bundler</a> - for building</p>
</li><li>
<p><a href="http://rspec.info">RSpec</a> - for testing</p>
</li></ul>

<h3 id="label-PostgreSQL">PostgreSQL</h3>

<p>PostgreSQL database server can be downloaded from <a
href="http://www.postgresql.org/download/">here</a>.</p>

<p>Alternatively,</p>
<ul><li>
<p>on Linux, you may run <code>apt-get install postgresql-9.4</code> to
install</p>
<ul><li>
<p>If you encounter error afterwards when executing <code>bundle
install</code> for <code>do_postgres</code> gem,  please install the dev
version instead <code>apt-get install postgresql-9.3
postgresql-server-dev-9.3 libpq-dev</code>,  for more information refer to
<a
href="https://github.com/datamapper/do/issues/66">github.com/datamapper/do/issues/66</a></p>
</li></ul>
</li><li>
<p>on OS X, you may install it using <a href="http://brew.sh">homebrew</a>
<code>brew install postgresql</code></p>
</li></ul>

<h3 id="label-Ruby">Ruby</h3>

<p>Ruby can be downloaded from <a
href="https://www.ruby-lang.org/en/downloads/">here</a>.</p>

<p>Alternatively, you can use <a href="https://rvm.io">rvm</a> to manage
different Ruby versions: <code>rvm install 2.1.5</code></p>

<p>Alternatively,</p>
<ul><li>
<p>on Linux, you may run <code>apt-get install ruby-full</code></p>
</li><li>
<p>on OS X, ruby 2.0 is pre-installed, but you may install 2.1.5 using <a
href="http://brew.sh">homebrew</a> <code>brew install ruby</code></p>
</li></ul>

<h3 id="label-RubyGems">RubyGems</h3>

<p>RubyGems can be downloaded from <a
href="https://rubygems.org/pages/download">here</a>.</p>

<h3 id="label-Ruby+on+Rails">Ruby on Rails</h3>

<p>Ruby on Rails can be downloaded from <a
href="http://rubyonrails.org/download/">here</a>.</p>

<p>Alternatively, you may run <code>gem install rails</code> to install.</p>

<h3 id="label-Yard+and+yard-tomdoc">Yard and yard-tomdoc</h3>

<p>Yard can be downloaded from <a href="http://yardoc.org">here</a></p>

<p>Alternatively, you may run <code>gem install yard</code> to install Yard,
and run <code>gem install yard-tomdoc</code> to install yard-tomdoc.</p>

<h3 id="label-Bundler">Bundler</h3>

<p>Bundler can be downloaded from <a href="http://bundler.io">here</a>.</p>

<p>Alternatively, you may run <code>gem install bundler</code> to install.</p>

<h3 id="label-RSpec">RSpec</h3>

<p>RSpec can be downloaded from <a href="http://rspec.info">here</a>.</p>

<p>Alternatively, you may run <code>gem install rspec</code> to install.</p>

<h2 id="label-Installation+Instructions">Installation Instructions</h2>

<h3 id="label-Gem">Gem</h3>
<ul><li>
<p>Open terminal/command line, go to directory
<code>/pvimpact-greenbutton</code></p>
</li><li>
<p>Run command <code>bundle install</code> to build the gem</p>
</li><li>
<p>Create PostgreSQL database <code>pvimpact_greenbutton</code></p>
<ul><li>
<p>Open terminal/command line, run <code>psql</code></p>
</li><li>
<p>Run <code>create database pvimpact_greenbutton;</code> in the
<code>psql</code> terminal</p>
</li></ul>
</li></ul>

<h3 id="label-Demo+Application">Demo Application</h3>
<ul><li>
<p>Make sure you have all prerequisites installed on your system.</p>
</li><li>
<p>Make sure you have started PostgreSQL database (e.g. <code>postgres -D
/usr/local/pgsql/data</code>)</p>
</li><li>
<p>Create PostgreSQL database <code>pvimpact_greenbutton_demo</code></p>
<ul><li>
<p>Open terminal/command line, run <code>psql</code></p>
</li><li>
<p>Run <code>create database pvimpact_greenbutton_demo;</code> in the
<code>psql</code> terminal</p>
</li></ul>
</li><li>
<p>(Optional) Adjust the database connection information in
<code>/config/application.rb</code></p>
</li><li>
<p>Open terminal/command line, go to directory
<code>/pvimpact-greenbutton-demo</code>.</p>
</li><li>
<p>Run command <code>bundle install</code> to install dependencies and build
the application.</p>
</li><li>
<p>Run command <code>rails server</code> to start the application</p>
</li></ul>

<p>Now the application should be running at
<code>http://0.0.0.0:3000/demo/index</code>, and you should see messages
like the following in console:</p>

<pre class="code ruby"><code class="ruby">[2015-03-28 01:51:51] INFO  WEBrick 1.3.1
[2015-03-28 01:51:51] INFO  ruby 2.1.2 (2014-05-08) [x86_64-darwin14.0]
[2015-03-28 01:51:51] INFO  WEBrick::HTTPServer#start: pid=66750 port=3000</code></pre>

<h2 id="label-Tests">Tests</h2>

<p><a href="http://rspec.info">RSpec</a> tests are written for major code of
the gem. The tests are organized under
<code>/pvimpact-greenbutton/spec</code> directory.</p>

<p>Please check <code>/pvimpact-greenbutton/spec/spec_helper.rb</code> to
change the <code>db_url</code> configuration option if needed.</p>

<p>Use the following commands to run tests (make sure you have PostgreSQL
database server running):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_rspec'>rspec</span></code></pre>

<p>NOTE that the tests may take quite a while, because some test cases do
aggregation to 15 minutes interval thus will generate huge number of
IntervalReading records into database.</p>

<p>The test coverage report can be found at
<code>/pvimpact-greenbutton/coverage/index.html</code>, current code
coverage is 97.27%.</p>

<h2 id="label-Usage+Examples">Usage Examples</h2>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pvimpact-greenbutton</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Configure the gem
</span><span class='const'>PVImpactGreenButton</span><span class='period'>.</span><span class='id identifier rubyid_configure'>configure</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_config'>config</span><span class='op'>|</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_db_url'>db_url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>postgres://user:password@localhost/pvimpact_greenbutton</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>

<span class='comment'># Create DB
</span><span class='const'>PVImpactGreenButton</span><span class='period'>.</span><span class='id identifier rubyid_create_db'>create_db</span>

<span class='comment'># Download Data without date range or aggregation
</span><span class='id identifier rubyid_usage_points'>usage_points</span> <span class='op'>=</span> <span class='const'>PVImpactGreenButton</span><span class='period'>.</span><span class='id identifier rubyid_download_data'>download_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>688b026c-665f-4994-9139-6b21b13fbeee</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://services.greenbuttondata.org/DataCustodian/espi/1_1/resource/Batch/Subscription/5</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Download Data with date range and aggregation
</span><span class='id identifier rubyid_usage_points'>usage_points</span> <span class='op'>=</span> <span class='const'>PVImpactGreenButton</span><span class='period'>.</span><span class='id identifier rubyid_download_data'>download_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>688b026c-665f-4994-9139-6b21b13fbeee</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://services.greenbuttondata.org/DataCustodian/espi/1_1/resource/Batch/Subscription/5</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2013</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2013</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>PVImpactGreenButton</span><span class='op'>::</span><span class='const'>AggregationType</span><span class='op'>::</span><span class='const'>ONE_DAY</span><span class='rparen'>)</span>

<span class='comment'># Retrieve persisted data without date range or aggregation
</span><span class='id identifier rubyid_usage_points'>usage_points</span> <span class='op'>=</span> <span class='const'>PVImpactGreenButton</span><span class='period'>.</span><span class='id identifier rubyid_retrieve_data'>retrieve_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://services.greenbuttondata.org/DataCustodian/espi/1_1/resource/Batch/Subscription/5</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Retrieve persisted data with date range and aggregation
</span><span class='id identifier rubyid_usage_points'>usage_points</span> <span class='op'>=</span> <span class='const'>PVImpactGreenButton</span><span class='period'>.</span><span class='id identifier rubyid_retrieve_data'>retrieve_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https://services.greenbuttondata.org/DataCustodian/espi/1_1/resource/Batch/Subscription/5</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2013</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='int'>2013</span><span class='comma'>,</span> <span class='int'>3</span><span class='comma'>,</span> <span class='int'>2</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>PVImpactGreenButton</span><span class='op'>::</span><span class='const'>AggregationType</span><span class='op'>::</span><span class='const'>ONE_DAY</span><span class='rparen'>)</span>
</code></pre>

<h2 id="label-Documentations">Documentations</h2>

<p>All code are documented using <a href="http://tomdoc.org">TomDoc</a>, and
the API documentations are generated using <a
href="http://yardoc.org">Yard</a> with <a
href="https://github.com/rubyworks/yard-tomdoc">yard-tomdoc</a> plugin. You
may find the generated API documentations under directory
<code>/pvimpact-greenbutton/doc</code>.</p>

<p>You may regenerate the documentations by running <code>yard --plugin
tomdoc</code></p>

<h2 id="label-Limitations">Limitations</h2>
<ul><li>
<p>This application currently supports &#39;electricity&#39; Usage Points
only.</p>
</li></ul>

<h2 id="label-References">References</h2>
<ul><li>
<p><a href="http://www.greenbuttondata.org">GreenButton</a></p>
</li><li>
<p><a href="http://www.greenbuttondata.org/developers/">GreenButton Developer
Resources</a></p>
</li></ul>
</div></div>

    <div id="footer">
  Generated on Tue Apr  7 22:31:27 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.1.5).
</div>

  </body>
</html>